<head>
<link href="bootstrap.min.css" rel="stylesheet">
<style>
.container {
    height: 100vh;
    overflow: auto;
}
.maincols {
height:77%;

}
.heads {
padding:5px;
}
.msgbox {
height:30%;
padding-top:2%;
background-color:#e5e8e7;
border-radius( 5px );
}
</style>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
</head>
<body style="height:100%;">
<div class="row" style='height:97%;'>
	<div class='col-7' style="height:100%; padding:0;">
		<div class='col-12 text-center border-bottom' style="height:20%;">
			<h1 >Query input</h1>
			<form class=" text-center" action="/action_page.php" style="padding:15px;">
				
				<input class="form-control col-8 offset-2" type="text" name='nlp' id='nlp' style="border: 5px solid #7ec7a5"><br>
		
				<button type="button" class="btn col-4" name='nlpbut' id='nlpbut' onclick='nlpsend()' style="margin-top:5">Submit</button>	 <!--style="background-color:#e5e8e7;border: 5px solid #7ec7a5"-->
			</form>
		</div>
		<div class='row text-center'>
			
				<div class='col-6 border-right maincols'>
					<h4 class="heads"><strong>Rule Based</strong></h4><hr>
						<div class="col-10 offset-1 msgbox" id='nlprule'>
							<p class="heads"><strong>Parsed Query</strong></p>
						</div><hr>
					<h5>Result</h5>
					<div style="height:30%"></div>
					<div><p>*semi-rule based nlp parser which can be used for most of the cases</p>
						<p>*Accuray improves based on the volume of data available</p>
					
					</div>
				</div>
				<div class='col-6 maincols'>
					<h4 class="heads"><strong>Graph</strong></h4><hr>
						<div class="col-10 offset-1 msgbox" id='nlprule'>
							<p class="heads"><strong>Parsed Query</strong></p>
						</div><hr>
						<h5>Result</h5>
						<div style="height:30%"></div>
					<div><p>* Graph based query parser in SPARQL</p>
						<p>* Universal, but graph DB lascks scalability on larger databases</p>
					
					</div>
				</div>
		</div>
		

	</div>
	<div class='col-3 border-left' style='height:97%;'>
		<h4 class="heads"><strong>Query Maker</strong></h4><hr><BR>
		<p> Find the </p>
			<select class="selectpicker form-control " multiple data-live-search="true" name='mm' id='mm'>
			  <option value='payment'>salary</option>
			  <option value='name'>employee name</option>
			  <option value='id'>employee id</option>
			  <option value='date'>payment date</option>
			  <option value='nickname'>short name</option>
			  <option value='phone'>phone</option>
			</select>
			
			<hr>
		
		<button type="button" class="btn col-6 offset-3" name='add' id='add' onclick='add()'>Add Condition</button>
		<p style='margin:15px;'> Where  </p>
		<div name='clause' class='row' id='clause'>
			

			
		
		</div>
		<button type="button" class="btn col-6 offset-3" name='sub' id='sub' onclick='rulesub()' style="margin-top:5">Submit</button>	
		<div class="col-10 offset-1 msgbox text-center" style='margin-top:5px;height:20%' id='qmpq'>
					<p class="heads"><strong>Parsed Query</strong></p>
		</div>
		<div style="height:5%"></div>
		<div><p>* Easy Query maker for non technical people</p>
			<p>* NLP is great but if you are unalble to get the required answer, This can be used as backup system</p>
					
		</div>
	</div>
	<div class='col-2 border-left text-center' style="height:100%; padding:0;">
		<h4 class="heads">Misc</h4><hr>
		<p>TAB1</p>
			<table class="table">
				<thead class="thead-dark">
					<tr>
					<th scope="col">id</th>
					<th scope="col">name</th>
					<th scope="col">nickname</th>
					<th scope="col">phone</th>
					</tr>
				</thead>
				<tbody>
					<tr>
					<th scope="row">1</th>
					<td>Mark</td>
					<td>Otto</td>
					<td>@mdo</td>
					</tr>
					<tr>
					<th scope="row">2</th>
					<td>Jacob</td>
					<td>Thornton</td>
					<td>@fat</td>
					</tr>
					<tr>
					<th scope="row">3</th>
					<td>Larry</td>
					<td>the Bird</td>
					<td>@twitter</td>
					</tr>
				</tbody>
			</table>
			<hr>
		<p>TAB2</p>
				
			<table class="table">
				<thead class="thead-light">
					<tr>
					<th scope="col">#</th>
					<th scope="col">payment</th>
					<th scope="col">date</th>
					<th scope="col">1id</th>
					</tr>
				</thead>
				<tbody>
					<tr>
					<th scope="row">1</th>
					<td>Mark</td>
					<td>Otto</td>
					<td>@mdo</td>
					</tr>
					<tr>
					<th scope="row">2</th>
					<td>Jacob</td>
					<td>Thornton</td>
					<td>@fat</td>
					</tr>
					<tr>
					<th scope="row">3</th>
					<td>Larry</td>
					<td>the Bird</td>
					<td>@twitter</td>
					</tr>
				</tbody>
			</table>
		
		
		
	</div>
</div>
<div class="text-center" style="height:3%;background-color:#7ec7a5;"> 
			<p style="margin-top:0">This Demo is created to showcase <strong>NLIDB</strong> architectures available at <strong>Virtusa Pvt Ltd</strong><p>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
<script>
//$( document ).ready(function() {
//  $('select').selectpicker();
//});
$('select').selectpicker();


//$('.selectpicker').change(function () {
//    var selectedItem = [];
//	selectedItem.push($(this).find("option:selected").val());
//    console.log(selectedItem);
//});
var sel = [];
$('.selectpicker').on('change', function(){
	var selected = []
    selected = $('.selectpicker').val()
	sel = selected;
    //console.log(selected); //Get the multiple values selected in an array
    //console.log(selected.length); //Length of the array
});
</script>
<script>
	
	b = 0;
	function add(){
		name = 'c' +b;
		b=b+1;
		//alert(name);
		var container = document.createElement("div");
		container.className = "col-4 ";
		container.innerHTML = "<select class='form-control  ' data-live-search='true' "+ "id='" + name +"' onchange='addre(this)'><option disabled selected='selected'> selects </option><option value='payment'>salary</option><option value='name'>employee name</option><option value='id'>employee id</option><option value='date'>payment date</option><option value='nickname'>short name</option><option value='phone'>phone</option></select>";
		document.getElementById("clause").appendChild(container); 
	}
	
	
	function addre(obj){
		var id = obj.id;
		//var val = obj.value;
		var nid = id + 're';
		var check = document.getElementById(nid);
		if(check == null){
			var container = document.createElement("div");
			container.className = "col-4 ";
			container.innerHTML = "<select class=' form-control  ' data-live-search='true' "+ "id='" + nid +"' onchange='addval(this)'><option disabled selected='selected'> selects </option><option value='='>Equals</option> <option value='BETWEEN'>Between/range</option> <option value='>'>Greater Than</option><option value='<'>Less Than</option><option value='>='>Greater Than or Equal To</option><option value='<='>Less Than or Equal To</option></select>" ;
			document.getElementById("clause").appendChild(container); 
		}
		
	}
	
	
	function addval(obj){
		//alert('working');
		var id = obj.id;
		var val = obj.value;
		var nid = id + 'va'; 
		var check = document.getElementById(nid);
		if(check == null){
			var container = document.createElement("div");
			container.className = "col-4";
			if (val == 'BETWEEN'){
				container.innerHTML =" <input type='text' class='form-control col-6' id='"+ nid + "1" +"'><input type='text' class='form-control col-6' id='"+ nid + "2" +"'>";
			}
			else {
				container.innerHTML =" <input type='text' class='form-control' id='"+ nid +"'>";
			}
			document.getElementById("clause").appendChild(container); 
		}
		else {
			//if (val == 'BETWEEN'){
			//	 document.getElementById(nid).innerHTML = " <input type='text' class='form-control col-6' id='"+ nid + "1" +"'><input type='text' class='form-control col-6' id='"+ nid + "2" +"'>";
			//}
			//else {
			//	 document.getElementById(nid).innerHTML  =" <input type='text' class='form-control' id='"+ nid +"'>";
			//}
		}
	}
	
	
	function rulesub(){
		var whe = [[]];	
		for(i=0;i<b;i++){
			sid = 'c' +i;
			rid = sid + 're';
			vid = rid + 'va';
			mainval = document.getElementById(sid).value;
			var relstr;
			relation = document.getElementById(rid).value;
			if(relation=='BETWEEN'){
				minv = vid + '1';
				maxv = vid + '2';
				relstr = relation  + ' ' +document.getElementById(minv).value +' ' + 'AND' +' ' + document.getElementById(maxv).value;
			}
			else{
				relstr = relation +' '+ document.getElementById(vid).value;
			}
			whe[i] = [mainval,relstr]; 
		}
		
		console.log(sel);
		console.log(whe);
		getresponse(sel,whe);
	}
</script>








<script>

    

function getresponse(sel,whe){

    //$('.result').text("");
	//var inputs = '{ "ent":"ee" , "prob":"pp" , "message" :"' + msg + '"}'
    //inputs = getFormData(".inputs");
    
	var inputs = {};
	inputs["sel"]=sel;
	inputs["whe"]=whe;
	inputs["ent"]='';
	
    //jquery AJAX post
    var url = "http://127.0.0.1:7000/querymaker"
    var data = JSON.stringify(inputs)
	//console.log(data);
	//serializes json into a string, opposite of parse
    $.post( url, data, function( data ) {
		
        response = data['results'];
		console.log(response);
        //recvmsg(response);
		//problem = data['results']['problem'];
		//entity = data['results']['entity'];
		//updside();
		//alert(sec);
		//console.log(response);
		//$('.result').append(response)
		qmpqdis(response);
        });
	
    
}
function qmpqdis(res){

	document.getElementById('qmpq').innerHTML ='<p>Parsed Query</p><strong>'+ res+'</strong>';
}


//function getFormData(form){
//    var json={};
//    var array = $(form).serializeArray();
//    $.each(array, function(){
//       json[this.name]=this.value || '';
//    });
//    return json;
//}
//
//

</script>
<script>
    

function nlpsend(){

    //$('.result').text("");
	//var inputs = '{ "ent":"ee" , "prob":"pp" , "message" :"' + msg + '"}'
    //inputs = getFormData(".inputs");
    var mmm = document.getElementById('nlp').value;
	console.log(mmm);
	var inputs = {};
	inputs["msg"]=mmm;
	
    //jquery AJAX post
    var url = "http://127.0.0.1:7000/nlp"
    var data = JSON.stringify(inputs)
	//console.log(data);
	//serializes json into a string, opposite of parse
    $.post( url, data, function( data ) {
		
        response = data['results'];
		console.log(response);
        //recvmsg(response);
		//problem = data['results']['problem'];
		//entity = data['results']['entity'];
		//updside();
		//alert(sec);
		//console.log(response);
		//$('.result').append(response)
		nlprdis(response);
        });
	
    
}
function nlprdis(res){

	document.getElementById('nlprule').innerHTML ='<p>Parsed Query</p><strong>'+ res+'</strong>';
}


//function getFormData(form){
//    var json={};
//    var array = $(form).serializeArray();
//    $.each(array, function(){
//       json[this.name]=this.value || '';
//    });
//    return json;
//}
//
//
</script>
<!--<script src="flask/js/jquery.js"></script>
<script src="flask/js/bootstrap.min.js"></script>-->

	

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    
    
    <!--raroc app -->
    
</body>





























